import 'package:flutter/material.dart';
import '../app_state.dart';

// Minimal, app-owned localization layer.
// Fallback behavior: if a key or language is missing, English is used.
class RoadyGoI18n {
  static const String kFallbackLang = 'en';

  static const Map<String, Map<String, String>> _strings = {
    'en': {
      // Common
      'back': 'Back',
      'skip': 'Skip',
      'next': 'Next',
      'continue': 'Continue',
      'confirm': 'Confirm',
      'dismiss': 'Dismiss',
      'close': 'Close',
      'search': 'Search',
      'select': 'Select',
      'loading': 'Loading...',

      // Auth
      'create_account': 'Create Account',
      'log_in': 'Log In',
      'welcome_back': 'Welcome Back',
      'sign_in_to_continue': 'Sign in to continue your journey',
      'full_name': 'Full Name',
      'enter_full_name': 'Enter your full name',
      'email_address': 'Email Address',
      'email_hint': 'you@example.com',
      'password': 'Password',
      'create_password': 'Create a strong password',
      'enter_password': 'Enter your password',
      'confirm_password': 'Confirm Password',
      'reenter_password': 'Re-enter your password',
      'mobile_number': 'Mobile Number',
      'get_started': 'Get Started',
      'forgot_password': 'Forgot Password?',
      'sign_in': 'Sign In',
      'or_continue_with': 'Or continue with',
      'or_get_a': 'Or get a',
      'quick_ride': 'Quick Ride',
      'enter_email_password': 'Please enter email and password',
      'passwords_do_not_match': 'Passwords do not match',
      'password_min_6': 'Password must be at least 6 characters',
      'enter_email_to_reset': 'Enter your email to reset password',
      'enter_valid_email': 'Please enter a valid email address',
      'agree_terms_privacy': 'Please agree to the Terms of Service and Privacy Policy',
      'terms_of_service': 'Terms of Service',
      'privacy_policy': 'Privacy Policy',
      'i_agree_to_the': 'I agree to the ',
      'and_word': ' and ',
      'password_reset_email_sent': 'Password reset email sent',
      'requires_recent_login_update_email':
          'Too long since most recent sign in. Sign in again before updating your email.',
      'requires_recent_login_delete_account':
          'Too long since most recent sign in. Sign in again before deleting your account.',

      // Reset password
      'reset_link_issue': 'Reset link issue',
      'invalid_or_incomplete_reset_link': 'Invalid or incomplete reset link.',
      'reset_link_invalid_or_expired': 'This reset link is invalid or expired.',
      'unable_to_validate_reset_link': 'Unable to validate reset link.',
      'back_to_login': 'Back to Login',
      'set_new_password': 'Set a new password',
      'reset_your_password': 'Reset your password',
      'account': 'Account',
      'new_password': 'New Password',
      'confirm_new_password': 'Confirm Password',
      'password_updated_successfully': 'Password updated successfully',
      'unable_to_reset_password': 'Unable to reset password',

      // Onboarding
      'onb1_title': 'Reliability in',
      'onb1_highlight': 'Every Mile',
      'onb1_desc':
          'Experience the next generation of logistics with real-time tracking and professional drivers.',
      'onb2_title': 'Help is on',
      'onb2_highlight': 'the Way',
      'onb2_desc':
          'Request professional towing and roadside assistance in just a few taps. We track your location to find the nearest provider.',
      'onb3_title': 'Safe and',
      'onb3_highlight': 'Secure',
      'onb3_desc':
          'Your vehicle is in expert hands. We provide fully insured transport and 24/7 support for your peace of mind.',

      // Home / booking
      'go_to_ride': 'Go to Ride',
      'book_your_ride': 'Book Your Ride',
      'pickup_point': 'Pickup Point',
      'select_pickup_point': 'Select Pickup Point',
      'destination': 'Destination',
      'select_destination': 'Select Destination',
      'time': 'Time',
      'pick_time_of_ride': 'Pick Time Of Ride',
      'ride_fee': 'Ride fee',
      'order_ride': 'Order Ride',
      'start_ride': 'Start Ride',

      // Destination picker
      'where_to': 'Where to?',
      'search_destination': 'Search destination...',
      'quick_search': 'Quick Search',
      'recent_destinations': 'Recent Destinations',
      'where_are_you_going': 'Where are you going',
      'where_are_you_going_q': 'Where are you going?',
      'ride_type': 'Ride type',
      'basic': 'Basic',
      'corporate': 'Corporate',
      'confirm_booking': 'Confirm Booking',
      'estimated_fare': 'Estimated Fare',
      'car_tow': 'Car Tow',
      'truck_tow': 'Truck Tow',
      'airport': 'Airport',
      'mall': 'Mall',
      'hospital': 'Hospital',
      'restaurant': 'Restaurant',
      'hotel': 'Hotel',
      'station': 'Station',
      'home': 'Home',
      'work': 'Work',
      'gym': 'Gym',

      // Rides
      'ride_details': 'Ride Details',
      'driver_details': 'Driver Details',
      'car_details': 'Car Details',
      'report_now': 'Report Now',
      'message': 'Message',
      'pickup_address': 'Pickup Address',
      'destination_address': 'Destination Address',
      'amount': 'Amount',
      'status': 'Status',
      'customer_details': 'Customer Details',
      'address': 'Address',
      'message_customer': 'Message Customer',
      'cancel_ride': 'Cancel Ride',
      'cancel_ride_q': 'Are you sure you want to cancel the ride',
      'ride_complete': 'Ride Complete',
      'ride_complete_desc':
          'You have arrived at your destination. Thank you for traveling with RoadyGo.',
      'ride_found': 'Ride Found',

      // Profile / settings page
      'user_details': 'User Details',
      'edit_profile': 'Edit Profile',
      'edit_profile_sub': 'Update personal information',
      'languages': 'Languages',
      'languages_sub': 'Change app language',
      'add_scheduled_ride': 'Add Scheduled Ride',
      'add_scheduled_ride_sub': 'Book a new delivery',
      'scheduled_rides': 'Scheduled Rides',
      'scheduled_rides_sub': 'View upcoming trips',
      'recent_rides': 'Recent Rides',
      'recent_rides_sub': 'History of past deliveries',
      'dark_light_mode': 'Dark/Light Mode',
      'switch_to_dark': 'Switch to Dark Mode',
      'switch_to_light': 'Switch to Light Mode',
      'log_out': 'Log Out',
      'log_out_q': 'Log out?',
      'cancel': 'Cancel',
      'my_recent_rides': 'My Recent Rides',
      'my_scheduled_rides': 'My Scheduled Rides',
      'scheduled': 'Scheduled',
      'instant': 'Instant',
      'no_rides_yet': 'No rides yet',
      'no_rides_desc':
          'When you complete a ride, it will show up here with its route, time, and fare.',
      'trips_realtime_desc':
          'Your completed and scheduled trips, updated in real time.',
      'time_not_set': 'Time not set',
      'pickup_not_set': 'Pickup not set',
      'destination_not_set': 'Destination not set',
      'status_label': 'Status',
      'book_a_ride': 'Book a ride',
      'select_language': 'Select language',
      'search_language': 'Search languages',
      'current_language': 'Current language',

      'profile': 'Profile',
      'premium_member': 'PREMIUM MEMBER',
      'total_rides': 'Total Rides',
      'points': 'Points',
      'co2_saved': 'CO2 Saved',
      'payment_methods': 'Payment Methods',
      'ride_history': 'Ride History',
      'my_vehicles': 'My Vehicles',
      'saved_places': 'Saved Places',
      'complete_profile': 'Complete Profile',
      'complete_profile_desc':
          'Fill in the details below to complete\nyour account registration',
      'upload_photo': 'Upload Photo',
      'phone_number': 'Phone Number',
      'location': 'Location',
      'location_not_set': 'Location not set',
      'fetching_location': 'Fetching current location...',
      'location_permission_denied': 'Location permission denied',
      'location_services_disabled': 'Location services are disabled',
      'user': 'User',
      'finish_setup': 'Finish Setup',
      'finish_legal': 'By tapping Finish, you agree to our Terms and Privacy Policy.',
    },
    'fr': {
      'back': 'Retour',
      'skip': 'Ignorer',
      'next': 'Suivant',
      'continue': 'Continuer',
      'confirm': 'Confirmer',
      'dismiss': 'Fermer',
      'search': 'Rechercher',
      'select': 'Sélectionner',

      'create_account': 'Créer un compte',
      'log_in': 'Connexion',
      'welcome_back': 'Bon retour',
      'sign_in_to_continue': 'Connectez-vous pour continuer',
      'full_name': 'Nom complet',
      'email_address': 'Adresse e-mail',
      'password': 'Mot de passe',
      'confirm_password': 'Confirmer le mot de passe',
      'mobile_number': 'Numéro de téléphone',
      'get_started': 'Commencer',
      'forgot_password': 'Mot de passe oublié ?',
      'sign_in': 'Se connecter',
      'or_continue_with': 'Ou continuer avec',
      'quick_ride': 'Course rapide',

      'user_details': 'Détails utilisateur',
      'edit_profile': 'Modifier le profil',
      'edit_profile_sub': 'Mettre à jour vos informations',
      'languages': 'Langues',
      'languages_sub': "Changer la langue de l'application",
      'add_scheduled_ride': 'Ajouter une course planifiée',
      'add_scheduled_ride_sub': 'Réserver une nouvelle course',
      'scheduled_rides': 'Courses planifiées',
      'scheduled_rides_sub': 'Voir les trajets à venir',
      'recent_rides': 'Courses récentes',
      'recent_rides_sub': 'Historique des trajets',
      'dark_light_mode': 'Mode sombre/clair',
      'switch_to_dark': 'Passer en mode sombre',
      'switch_to_light': 'Passer en mode clair',
      'log_out': 'Déconnexion',
      'log_out_q': 'Se déconnecter ?',
      'cancel': 'Annuler',
      'my_recent_rides': 'Mes courses récentes',
      'no_rides_yet': 'Aucune course',
      'no_rides_desc':
          "Quand vous terminerez une course, elle s'affichera ici avec l’itinéraire, l’heure et le tarif.",
      'book_a_ride': 'Réserver',
      'select_language': 'Choisir une langue',
      'search_language': 'Rechercher',
      'current_language': 'Langue actuelle',
      'location_not_set': 'Localisation non définie',
      'fetching_location': 'Récupération de la position...',
      'location_permission_denied': 'Autorisation de localisation refusée',
      'location_services_disabled': 'Les services de localisation sont désactivés',
    },
    'de': {
      'back': 'Zurueck',
      'skip': 'Ueberspringen',
      'next': 'Weiter',
      'continue': 'Fortfahren',
      'confirm': 'Bestaetigen',
      'dismiss': 'Schliessen',
      'search': 'Suchen',
      'select': 'Auswaehlen',

      'create_account': 'Konto erstellen',
      'log_in': 'Anmelden',
      'welcome_back': 'Willkommen zurueck',
      'sign_in_to_continue': 'Melde dich an, um fortzufahren',
      'full_name': 'Vollstaendiger Name',
      'email_address': 'E-Mail-Adresse',
      'password': 'Passwort',
      'confirm_password': 'Passwort bestaetigen',
      'mobile_number': 'Telefonnummer',
      'get_started': 'Loslegen',
      'forgot_password': 'Passwort vergessen?',
      'sign_in': 'Anmelden',
      'or_continue_with': 'Oder weiter mit',
      'quick_ride': 'Schnelle Fahrt',

      'user_details': 'Benutzerdaten',
      'edit_profile': 'Profil bearbeiten',
      'edit_profile_sub': 'Persönliche Daten aktualisieren',
      'languages': 'Sprachen',
      'languages_sub': 'App-Sprache ändern',
      'add_scheduled_ride': 'Geplante Fahrt hinzufügen',
      'add_scheduled_ride_sub': 'Neue Fahrt buchen',
      'scheduled_rides': 'Geplante Fahrten',
      'scheduled_rides_sub': 'Bevorstehende Fahrten ansehen',
      'recent_rides': 'Letzte Fahrten',
      'recent_rides_sub': 'Verlauf der Fahrten',
      'dark_light_mode': 'Hell/Dunkel',
      'switch_to_dark': 'Zu Dunkel wechseln',
      'switch_to_light': 'Zu Hell wechseln',
      'log_out': 'Abmelden',
      'log_out_q': 'Abmelden?',
      'cancel': 'Abbrechen',
      'my_recent_rides': 'Meine letzten Fahrten',
      'no_rides_yet': 'Noch keine Fahrten',
      'no_rides_desc':
          'Sobald du eine Fahrt abgeschlossen hast, erscheint sie hier mit Route, Zeit und Preis.',
      'book_a_ride': 'Fahrt buchen',
      'select_language': 'Sprache wählen',
      'search_language': 'Sprachen suchen',
      'current_language': 'Aktuelle Sprache',
      'location_not_set': 'Standort nicht gesetzt',
      'fetching_location': 'Standort wird abgerufen...',
      'location_permission_denied': 'Standortberechtigung verweigert',
      'location_services_disabled': 'Standortdienste sind deaktiviert',
    },
    'es': {
      'back': 'Atras',
      'skip': 'Saltar',
      'next': 'Siguiente',
      'continue': 'Continuar',
      'confirm': 'Confirmar',
      'dismiss': 'Cerrar',
      'search': 'Buscar',
      'select': 'Seleccionar',

      'create_account': 'Crear cuenta',
      'log_in': 'Iniciar sesion',
      'welcome_back': 'Bienvenido de nuevo',
      'sign_in_to_continue': 'Inicia sesion para continuar',
      'full_name': 'Nombre completo',
      'email_address': 'Correo electronico',
      'password': 'Contrasena',
      'confirm_password': 'Confirmar contrasena',
      'mobile_number': 'Numero de telefono',
      'get_started': 'Comenzar',
      'forgot_password': 'Olvidaste tu contrasena?',
      'sign_in': 'Iniciar sesion',
      'or_continue_with': 'O continuar con',
      'quick_ride': 'Viaje rapido',

      'user_details': 'Detalles del usuario',
      'edit_profile': 'Editar perfil',
      'edit_profile_sub': 'Actualiza tu información',
      'languages': 'Idiomas',
      'languages_sub': 'Cambiar el idioma',
      'add_scheduled_ride': 'Agregar viaje programado',
      'add_scheduled_ride_sub': 'Reservar un nuevo viaje',
      'scheduled_rides': 'Viajes programados',
      'scheduled_rides_sub': 'Ver próximos viajes',
      'recent_rides': 'Viajes recientes',
      'recent_rides_sub': 'Historial de viajes',
      'dark_light_mode': 'Modo oscuro/claro',
      'switch_to_dark': 'Cambiar a oscuro',
      'switch_to_light': 'Cambiar a claro',
      'log_out': 'Cerrar sesión',
      'log_out_q': '¿Cerrar sesión?',
      'cancel': 'Cancelar',
      'my_recent_rides': 'Mis viajes recientes',
      'no_rides_yet': 'Aún no hay viajes',
      'no_rides_desc':
          'Cuando completes un viaje, aparecerá aquí con ruta, hora y tarifa.',
      'book_a_ride': 'Reservar',
      'select_language': 'Seleccionar idioma',
      'search_language': 'Buscar',
      'current_language': 'Idioma actual',
      'location_not_set': 'Ubicación no establecida',
      'fetching_location': 'Obteniendo ubicación...',
      'location_permission_denied': 'Permiso de ubicación denegado',
      'location_services_disabled': 'Los servicios de ubicación están deshabilitados',
    },
    'it': {
      'back': 'Indietro',
      'skip': 'Salta',
      'next': 'Avanti',
      'continue': 'Continua',
      'confirm': 'Conferma',
      'dismiss': 'Chiudi',
      'search': 'Cerca',
      'select': 'Seleziona',

      'create_account': 'Crea account',
      'log_in': 'Accedi',
      'welcome_back': 'Bentornato',
      'sign_in_to_continue': 'Accedi per continuare',
      'full_name': 'Nome completo',
      'email_address': 'Email',
      'password': 'Password',
      'confirm_password': 'Conferma password',
      'mobile_number': 'Numero di telefono',
      'get_started': 'Inizia',
      'forgot_password': 'Password dimenticata?',
      'sign_in': 'Accedi',
      'or_continue_with': 'Oppure continua con',
      'quick_ride': 'Corsa rapida',

      'user_details': 'Dettagli utente',
      'edit_profile': 'Modifica profilo',
      'edit_profile_sub': 'Aggiorna le informazioni',
      'languages': 'Lingue',
      'languages_sub': "Cambia la lingua dell'app",
      'add_scheduled_ride': 'Aggiungi corsa programmata',
      'add_scheduled_ride_sub': 'Prenota una nuova corsa',
      'scheduled_rides': 'Corse programmate',
      'scheduled_rides_sub': 'Vedi le prossime corse',
      'recent_rides': 'Corse recenti',
      'recent_rides_sub': 'Cronologia corse',
      'dark_light_mode': 'Modalità scura/chiara',
      'switch_to_dark': 'Passa a scura',
      'switch_to_light': 'Passa a chiara',
      'log_out': 'Esci',
      'log_out_q': 'Uscire?',
      'cancel': 'Annulla',
      'my_recent_rides': 'Le mie corse recenti',
      'no_rides_yet': 'Nessuna corsa',
      'no_rides_desc':
          'Quando completi una corsa, apparirà qui con percorso, orario e tariffa.',
      'book_a_ride': 'Prenota',
      'select_language': 'Seleziona lingua',
      'search_language': 'Cerca',
      'current_language': 'Lingua attuale',
      'location_not_set': 'Posizione non impostata',
      'fetching_location': 'Recupero posizione...',
      'location_permission_denied': 'Permesso posizione negato',
      'location_services_disabled': 'I servizi di localizzazione sono disattivati',
    },
    'pt': {
      'back': 'Voltar',
      'skip': 'Pular',
      'next': 'Proximo',
      'continue': 'Continuar',
      'confirm': 'Confirmar',
      'dismiss': 'Fechar',
      'search': 'Pesquisar',
      'select': 'Selecionar',

      'create_account': 'Criar conta',
      'log_in': 'Entrar',
      'welcome_back': 'Bem-vindo de volta',
      'sign_in_to_continue': 'Entre para continuar',
      'full_name': 'Nome completo',
      'email_address': 'Email',
      'password': 'Senha',
      'confirm_password': 'Confirmar senha',
      'mobile_number': 'Numero de telefone',
      'get_started': 'Comecar',
      'forgot_password': 'Esqueceu a senha?',
      'sign_in': 'Entrar',
      'or_continue_with': 'Ou continuar com',
      'quick_ride': 'Corrida rapida',

      'user_details': 'Detalhes do usuário',
      'edit_profile': 'Editar perfil',
      'edit_profile_sub': 'Atualize suas informações',
      'languages': 'Idiomas',
      'languages_sub': 'Alterar idioma do app',
      'add_scheduled_ride': 'Adicionar corrida agendada',
      'add_scheduled_ride_sub': 'Agendar uma nova corrida',
      'scheduled_rides': 'Corridas agendadas',
      'scheduled_rides_sub': 'Ver próximas corridas',
      'recent_rides': 'Corridas recentes',
      'recent_rides_sub': 'Histórico de corridas',
      'dark_light_mode': 'Modo escuro/claro',
      'switch_to_dark': 'Mudar para escuro',
      'switch_to_light': 'Mudar para claro',
      'log_out': 'Sair',
      'log_out_q': 'Sair?',
      'cancel': 'Cancelar',
      'my_recent_rides': 'Minhas corridas recentes',
      'no_rides_yet': 'Nenhuma corrida ainda',
      'no_rides_desc':
          'Quando você concluir uma corrida, ela aparecerá aqui com rota, hora e valor.',
      'book_a_ride': 'Agendar',
      'select_language': 'Selecionar idioma',
      'search_language': 'Pesquisar',
      'current_language': 'Idioma atual',
      'location_not_set': 'Localização não definida',
      'fetching_location': 'Obtendo localização...',
      'location_permission_denied': 'Permissão de localização negada',
      'location_services_disabled': 'Serviços de localização desativados',
    },
    'nl': {
      'back': 'Terug',
      'skip': 'Overslaan',
      'next': 'Volgende',
      'continue': 'Doorgaan',
      'confirm': 'Bevestigen',
      'dismiss': 'Sluiten',
      'search': 'Zoeken',
      'select': 'Selecteren',

      'create_account': 'Account maken',
      'log_in': 'Inloggen',
      'welcome_back': 'Welkom terug',
      'sign_in_to_continue': 'Log in om door te gaan',
      'full_name': 'Volledige naam',
      'email_address': 'E-mailadres',
      'password': 'Wachtwoord',
      'confirm_password': 'Bevestig wachtwoord',
      'mobile_number': 'Telefoonnummer',
      'get_started': 'Starten',
      'forgot_password': 'Wachtwoord vergeten?',
      'sign_in': 'Inloggen',
      'or_continue_with': 'Of doorgaan met',
      'quick_ride': 'Snelle rit',

      'user_details': 'Gebruikersgegevens',
      'edit_profile': 'Profiel bewerken',
      'edit_profile_sub': 'Persoonlijke info bijwerken',
      'languages': 'Talen',
      'languages_sub': 'App-taal wijzigen',
      'add_scheduled_ride': 'Geplande rit toevoegen',
      'add_scheduled_ride_sub': 'Boek een nieuwe rit',
      'scheduled_rides': 'Geplande ritten',
      'scheduled_rides_sub': 'Bekijk komende ritten',
      'recent_rides': 'Recente ritten',
      'recent_rides_sub': 'Ritgeschiedenis',
      'dark_light_mode': 'Donker/licht',
      'switch_to_dark': 'Naar donker',
      'switch_to_light': 'Naar licht',
      'log_out': 'Uitloggen',
      'log_out_q': 'Uitloggen?',
      'cancel': 'Annuleren',
      'my_recent_rides': 'Mijn recente ritten',
      'no_rides_yet': 'Nog geen ritten',
      'no_rides_desc':
          'Zodra je een rit voltooit, verschijnt die hier met route, tijd en prijs.',
      'book_a_ride': 'Boek een rit',
      'select_language': 'Kies taal',
      'search_language': 'Zoeken',
      'current_language': 'Huidige taal',
      'location_not_set': 'Locatie niet ingesteld',
      'fetching_location': 'Locatie ophalen...',
      'location_permission_denied': 'Locatietoestemming geweigerd',
      'location_services_disabled': 'Locatieservices zijn uitgeschakeld',
    },
  };

  // European languages list for picker (name shown in English).
  // Some languages may fall back to English strings until translated.
  static const List<({String code, String name})> europeanLanguages = [
    (code: 'en', name: 'English'),
    (code: 'fr', name: 'French'),
    (code: 'de', name: 'German'),
    (code: 'es', name: 'Spanish'),
    (code: 'it', name: 'Italian'),
    (code: 'pt', name: 'Portuguese'),
    (code: 'nl', name: 'Dutch'),
    (code: 'sv', name: 'Swedish'),
    (code: 'nb', name: 'Norwegian'),
    (code: 'da', name: 'Danish'),
    (code: 'fi', name: 'Finnish'),
    (code: 'pl', name: 'Polish'),
    (code: 'cs', name: 'Czech'),
    (code: 'sk', name: 'Slovak'),
    (code: 'hu', name: 'Hungarian'),
    (code: 'ro', name: 'Romanian'),
    (code: 'bg', name: 'Bulgarian'),
    (code: 'el', name: 'Greek'),
    (code: 'hr', name: 'Croatian'),
    (code: 'sr', name: 'Serbian'),
    (code: 'sl', name: 'Slovenian'),
    (code: 'lt', name: 'Lithuanian'),
    (code: 'lv', name: 'Latvian'),
    (code: 'et', name: 'Estonian'),
    (code: 'ga', name: 'Irish'),
    (code: 'mt', name: 'Maltese'),
  ];

  static String t(BuildContext context, String key) {
    // Prefer the persisted app setting to avoid relying on inherited widgets in
    // contexts where Localizations might not be available.
    final persisted = FFAppState().languageCode;
    final code = persisted.isNotEmpty ? persisted : Localizations.localeOf(context).languageCode;
    final lang = _strings.containsKey(code) ? code : kFallbackLang;
    return _strings[lang]?[key] ?? _strings[kFallbackLang]![key] ?? key;
  }
}

extension RoadyGoI18nExt on BuildContext {
  String tr(String key) => RoadyGoI18n.t(this, key);
}
